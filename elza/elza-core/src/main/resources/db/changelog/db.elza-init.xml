<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <!--Verze 2.x - vytvoreni schematu databaze-->
    <changeSet id="1" author="ppyt">
        <validCheckSum>ANY</validCheckSum>
        <createTable tableName="db_hibernate_sequences">
            <column name="sequence_name" type="nvarchar(255)">
                <constraints primaryKey="true"/>
            </column>
            <column name="next_val" type="bigint"/>
        </createTable>

        <!--pridani tabulky jazyka-->
        <createTable tableName="sys_language">
            <column name="language_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(3)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!--jazyková data-->
        <insert tableName="sys_language">
            <column name="language_id">0</column>
            <column name="code">cze</column>
            <column name="name">čeština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">1</column><column name="code">eng</column><column name="name">angličtina</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">2</column><column name="code">ger</column><column name="name">němčina</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">3</column><column name="code">rus</column><column name="name">ruština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">4</column><column name="code">lat</column><column name="name">latina</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">5</column><column name="code">slo</column><column name="name">slovenština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">6</column><column name="code">pol</column><column name="name">polština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">7</column><column name="code">ita</column><column name="name">italština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">8</column><column name="code">fre</column><column name="name">francouzština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">9</column><column name="code">spa</column><column name="name">španělština</column>
        </insert>
        <insert tableName="sys_language">
            <column name="language_id">10</column><column name="code">heb</column><column name="name">hebrejština</column>
        </insert>

        <!-- rul_data_type table -->
        <createTable tableName="rul_data_type">
            <column name="data_type_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="${type.text}">
                <constraints nullable="false"/>
            </column>
            <column name="regexp_use" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="text_length_limit_use" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="storage_table" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <!-- rul_data_type data -->
        <insert tableName="rul_data_type" ><column name="data_type_id" value="1"/><column name="code" value="INT"/><column name="name" value="Celé číslo"/><column name="description" value="Celé číslo."/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_integer"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="2"/><column name="code" value="STRING"/><column name="name" value="Řetězec"/><column name="description" value="Textový řetězec o maximální délce 250 znaků."/><column name="regexp_use" value="true"/><column name="text_length_limit_use" value="true"/><column name="storage_table" value="arr_data_string"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="3"/><column name="code" value="TEXT"/><column name="name" value="Text"/><column name="description" value="Textové pole pro dlouhý text."/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_text"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="4"/><column name="code" value="UNITDATE"/><column name="name" value="Datace"/><column name="description" value="Prvek pro uložení datace včetně rozsahu, tj. od-do"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_unitdate"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="5"/><column name="code" value="UNITID"/><column name="name" value="Referenční číslo"/><column name="description" value="Referenční číslo"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_unitid"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="6"/><column name="code" value="FORMATTED_TEXT"/><column name="name" value="Formátovaný text"/><column name="description" value="Pole pro formátovaný text"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_text"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="7"/><column name="code" value="COORDINATES"/><column name="name" value="Souřadnice"/><column name="description" value="Souřadnice mapy či jiného objektu"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_coordinates"/></insert>
        <insert tableName="rul_data_type" ><column name="data_type_id" value="8"/><column name="code" value="RECORD_REF"/><column name="name" value="Záznam v rejstříku"/><column name="description" value="Odkaz na záznam v rejstříku"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_record_ref"/></insert>
        <insert tableName="rul_data_type"><column name="data_type_id"  value="9"/><column name="code" value="DECIMAL"/><column name="name" value="Desetinné číslo"/><column name="description" value="Desetinné číslo"/><column name="regexp_use" value="false"/><column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_decimal"/></insert>
        <insert tableName="rul_data_type"><column name="data_type_id" value="10"/><column name="code" value="ENUM"/><column name="name" value="Výčet"/>
            <column name="description" value="Výčet"/><column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/><column name="storage_table" value="arr_data_null"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="11"/>
            <column name="code" value="FILE_REF"/>
            <column name="name" value="Příloha"/>
            <column name="description" value="Příloha"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_file_ref"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="12"/>
            <column name="code" value="JSON_TABLE"/>
            <column name="name" value="Tabulka"/>
            <column name="description" value="Tabulka ukládaná jako JSON"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_json_table"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="13"/>
            <column name="code" value="STRUCTURED"/>
            <column name="name" value="Strukturovaný typ"/>
            <column name="description" value="Strukturovaný datový typ složený z 'archivního popisu'"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_structured"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="14"/>
            <column name="code" value="DATE"/>
            <column name="name" value="Datum"/>
            <column name="description" value="Datový typ prvku popisu (Date) pro zadání běžného občanského data"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_date"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="15"/>
            <column name="code" value="URI_REF"/>
            <column name="name" value="Obecný URI odkaz"/>
            <column name="description" value="Obecný URI odkaz, který lze použít jako URL odkaz, ale i jako odkaz na jinou JP"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_uri_ref"/>
        </insert>
        <insert tableName="rul_data_type">
            <column name="data_type_id" value="16"/>
            <column name="code" value="BIT"/>
            <column name="name" value="Boolean hodnota"/>
            <column name="description" value="Boolean hodnota"/>
            <column name="regexp_use" value="false"/>
            <column name="text_length_limit_use" value="false"/>
            <column name="storage_table" value="arr_data_bit"/>
        </insert>
        <!-- rul_data_type db_hibernate_sequences -->
        <insert tableName="db_hibernate_sequences">
            <column name="sequence_name" value="rul_data_type|data_type_id"/>
            <column name="next_val" value="16"/>
        </insert>

        <!-- rul_package table -->
        <createTable tableName="rul_package">
            <column name="package_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="description" type="${type.text}">
                <constraints nullable="true"/>
            </column>
            <column name="version" type="int"/>
        </createTable>
        
        <!-- rul_package_dependency table -->
        <createTable tableName="rul_package_dependency">
            <column name="package_dependency_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_rul_package_source_package" referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="depends_on_package_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_rul_package_target_package" referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="min_version" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- rul_component table -->
        <createTable tableName="rul_component">
            <column name="component_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="filename" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="hash" type="nvarchar(64)"/>
        </createTable>

        <!-- sys_external_system table -->
        <createTable tableName="sys_external_system">
            <column name="external_system_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="url" type="nvarchar(1000)"/>
            <column name="username" type="nvarchar(50)"/>
            <column name="password" type="nvarchar(50)"/>
            <column name="elza_code" type="nvarchar(50)"/>
            <column name="api_key_id" type="nvarchar(50)"/>
            <column name="api_key_value" type="nvarchar(250)"/>
        </createTable>

        <!-- ap_external_system table -->
        <createTable tableName="ap_external_system">
            <column name="external_system_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_external_system" nullable="false"/>
            </column>
            <column name="type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="scope_id" type="int"/>
            <column name="user_info" type="nvarchar(50)"/>
            <column name="publish_only_approved" type="boolean"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_sys_external_system"
                                 baseTableName="ap_external_system" baseColumnNames="external_system_id"
                                 referencedTableName="sys_external_system" referencedColumnNames="external_system_id"/>

        <!-- gis_external_system table -->
        <createTable tableName="gis_external_system">
            <column name="external_system_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_gis_external_system" nullable="false"/>
            </column>
            <column name="type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_gis_external_system" 
                                 baseTableName="gis_external_system" baseColumnNames="external_system_id"
                                 referencedTableName="sys_external_system" referencedColumnNames="external_system_id"/>

        <!-- sys_external_system_property table -->
        <createTable tableName="sys_external_system_property">
            <column name="external_system_property_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_sys_external_system_property" nullable="false"/>
            </column>
            <column name="external_system_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="int"/>
            <column name="name" type="varchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="varchar(1000)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_sys_external_system_property_sys_external_system" 
                                 baseTableName="sys_external_system_property" baseColumnNames="external_system_id"
                                 referencedTableName="sys_external_system" referencedColumnNames="external_system_id"/>

        <!-- rul_rule_set table -->
        <createTable tableName="rul_rule_set">
            <column name="rule_set_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(50)"/>
            <column name="name" type="nvarchar(250)"/>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="rule_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="item_type_component_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_rule_set_package" 
                                 baseTableName="rul_rule_set" baseColumnNames="package_id" 
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_rul_rule_set_item_type_component"
                                 baseTableName="rul_rule_set" baseColumnNames="item_type_component_id"
                                 referencedTableName="rul_component" referencedColumnNames="component_id"/>

        <!-- rul_policy_type table -->
        <createTable tableName="rul_policy_type">
            <column name="policy_type_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_policy_type_package" baseTableName="rul_policy_type"
                                 baseColumnNames="package_id" referencedTableName="rul_package"
                                 referencedColumnNames="package_id"
                                 onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_rul_policy_type_rule_set" baseTableName="rul_policy_type"
                                 baseColumnNames="rule_set_id" referencedTableName="rul_rule_set"
                                 referencedColumnNames="rule_set_id"
                                 onDelete="NO ACTION"/>

        <!-- rul_action table -->
        <createTable tableName="rul_action">
            <column name="action_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="filename" type="nvarchar(250)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_action_rul_rule_set" baseTableName="rul_action"
                                 baseColumnNames="rule_set_id" referencedTableName="rul_rule_set"
                                 referencedColumnNames="rule_set_id"
                                 onDelete="NO ACTION"/>

        <!-- rul_output_type table -->
        <createTable tableName="rul_output_type">
            <column name="output_type_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="component_id" type="int">
                <constraints foreignKeyName="fk_rul_output_type_component"
                             referencedTableName="rul_component"
                             referencedColumnNames="component_id"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_output_type_package"
                                 baseTableName="rul_output_type" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_rul_output_type_rul_rule_set"
                                 baseTableName="rul_output_type" baseColumnNames="rule_set_id"
                                 referencedTableName="rul_rule_set" referencedColumnNames="rule_set_id"
                                 onDelete="NO ACTION"/>

        <!-- rul_action_recommended table -->
        <createTable tableName="rul_action_recommended">
            <column name="action_recommended_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="action_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="output_type_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_actionRecommended_action"
                                 baseTableName="rul_action_recommended"
                                 baseColumnNames="action_id"
                                 referencedTableName="rul_action"
                                 referencedColumnNames="action_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_actionRecommended_output_type"
                                 baseTableName="rul_action_recommended"
                                 baseColumnNames="output_type_id"
                                 referencedTableName="rul_output_type"
                                 referencedColumnNames="output_type_id"
                                 onDelete="NO ACTION"/>

        <!-- rul_template table -->
        <createTable tableName="rul_template">
            <column name="template_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="output_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="engine" type="char(10)">
                <constraints nullable="false"/>
            </column>
            <column name="directory" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column type="nvarchar(50)" name="extension">
                <constraints nullable="false"/>
            </column>
            <column type="nvarchar(50)" name="mime_type">
                <constraints nullable="false"/>
            </column>
            <column name="deleted" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="validation_schema" type="varchar(250)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rulTemplate_rulOutputType"
                                 baseTableName="rul_template" baseColumnNames="output_type_id"
                                 referencedTableName="rul_output_type" referencedColumnNames="output_type_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_rulTemplate_rulPackage"
                                 baseTableName="rul_template" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>

        <!-- rul_structured_type table -->
        <createTable tableName="rul_structured_type">
            <column name="structured_type_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_type_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="anonymous" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- rul_structure_definition table -->
        <createTable tableName="rul_structure_definition">
            <column name="structure_definition_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="def_type" type="nvarchar(50)"/>
            <column name="priority" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="component_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_definition_component"
                             referencedTableName="rul_component"
                             referencedColumnNames="component_id"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_definition_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="structured_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_definition_structure_type"
                             referencedTableName="rul_structured_type"
                             referencedColumnNames="structured_type_id"/>
            </column>
            <column name="compatibility_rul_package" type="int"/>
        </createTable>

        <!-- rul_structured_type_extension table -->
        <createTable tableName="rul_structured_type_extension">
            <column name="structured_type_extension_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_rul_structure_extension"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_extension_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="structured_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_extension_structure_type"
                             referencedTableName="rul_structured_type"
                             referencedColumnNames="structured_type_id"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true" uniqueConstraintName="rul_structure_extension_code_key"/>
            </column>
        </createTable>

        <!-- rul_structure_extension_definition table -->
        <createTable tableName="rul_structure_extension_definition">
            <column name="structure_extension_definition_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="def_type" type="nvarchar(50)"/>
            <column name="priority" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="component_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_extension_definition_component"
                             referencedTableName="rul_component"
                             referencedColumnNames="component_id"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_extension_definition_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="structured_type_extension_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_structure_extension_definition_structure_extension"
                             referencedTableName="rul_structured_type_extension"
                             referencedColumnNames="structured_type_extension_id"/>
            </column>
            <column name="compatibility_rul_package" type="int"/>
        </createTable>

        <!-- dms_file table -->
        <createTable tableName="dms_file">
            <column name="file_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="file_name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="file_size" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="mime_type" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="pages_count" type="int">
                <constraints nullable="true"/>
            </column>
        </createTable>

        <!-- ap_scope table -->
        <createTable tableName="ap_scope">
            <column name="scope_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_scope" nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="language_id" type="int"/>
            <column name="rule_set_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_scope_language"
                                 baseTableName="ap_scope" baseColumnNames="language_id"
                                 referencedTableName="sys_language" referencedColumnNames="language_id" onDelete="NO ACTION"/>
        <insert tableName="ap_scope">
            <column name="scope_id" value="1" type="int"/>
            <column name="code" value="GLOBAL"/>
            <column name="name" value="globální"/>
        </insert>
        <insert tableName="db_hibernate_sequences">
            <column name="sequence_name" value="ap_scope|scope_id"/>
            <column name="next_val" value="1"/>
        </insert>

        <!-- ap_type table -->
        <createTable tableName="ap_type">
            <column name="ap_type_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_type" nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true" uniqueConstraintName="reg_register_type_code_key"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="parent_ap_type_id" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="read_only" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_apType_apType"
                                 baseColumnNames="parent_ap_type_id" baseTableName="ap_type"
                                 referencedColumnNames="ap_type_id" referencedTableName="ap_type"/>
        <addForeignKeyConstraint constraintName="fk_ap_type_package"
                                 baseColumnNames="package_id" baseTableName="ap_type"
                                 referencedColumnNames="package_id" referencedTableName="rul_package"/>

        <!-- ap_external_id_type table -->
        <createTable tableName="ap_external_id_type">
            <column name="external_id_type_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- ap_change table -->
        <createTable tableName="ap_change">
            <column name="change_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="change_date" type="timestamp with time zone"/>
            <column name="user_id" type="int"/>
            <column name="type" type="char(20)"/>
            <column name="external_system_id" type="int">
                <constraints nullable="true" foreignKeyName="fk_ap_change_external_system" references="ap_external_system(external_system_id)"/>
            </column>
        </createTable>

        <!-- par_institution_type table -->
        <createTable tableName="par_institution_type">
            <column name="institution_type_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <insert tableName="par_institution_type" >
            <column name="institution_type_id" value="1"/>
            <column name="code" value="DEFAULT"/>
            <column name="name" value="Výchozí"/>
        </insert>
        <insert tableName="db_hibernate_sequences">
            <column name="sequence_name" value="par_institution_type|institution_type_id"/>
            <column name="next_val" value="1"/>
        </insert>

        <!-- par_institution table -->
        <createTable tableName="par_institution">
            <column name="institution_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="institution_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="internal_code" type="nvarchar(250)">
                <constraints nullable="true"/>
            </column>
            <column name="access_point_id" type="integer"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_institution_institutionType"
                                 baseTableName="par_institution" baseColumnNames="institution_type_id"
                                 referencedTableName="par_institution_type" referencedColumnNames="institution_type_id" onDelete="NO ACTION"/>

        <!-- usr_user table -->
        <createTable tableName="usr_user">
            <column name="user_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="username" type="nvarchar(250)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="active" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(250)"/>
            <column name="access_point_id" type="int"/>
        </createTable>

        <!-- usr_group table -->
        <createTable tableName="usr_group">
            <column name="group_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(250)"/>
        </createTable>

        <!-- usr_group_user table -->
        <createTable tableName="usr_group_user">
            <column name="group_user_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="user_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="group_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_group_user_user"
                                 baseTableName="usr_group_user" baseColumnNames="user_id"
                                 referencedTableName="usr_user" referencedColumnNames="user_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_group_user_group"
                                 baseTableName="usr_group_user" baseColumnNames="group_id"
                                 referencedTableName="usr_group" referencedColumnNames="group_id" onDelete="NO ACTION"/>

        <!-- rul_item_type table -->
        <createTable tableName="rul_item_type">
            <column name="item_type_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_rul_desc_item_type"/>
            </column>
            <column name="data_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false" uniqueConstraintName="rul_desc_item_type_code_key"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="shortcut" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="${type.text}">
                <constraints nullable="false"/>
            </column>
            <column name="is_value_unique" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="can_be_ordered" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="use_specification" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="view_order" type="int">
                <constraints nullable="false" unique="true" uniqueConstraintName="rul_desc_item_type_view_order_key"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="view_definition" type="${type.text}"/>
            <column name="structured_type_id" type="int">
                <constraints foreignKeyName="fk_rul_item_type_structure_type"
                             referencedTableName="rul_structured_type"
                             referencedColumnNames="structured_type_id"/>
            </column>
            <column name="string_length_limit" type="int">
                <constraints nullable="true"/>
            </column>
        </createTable>

        <!-- rul_item_spec table -->
        <createTable tableName="rul_item_spec">
            <column name="item_spec_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_rul_desc_item_spec"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false" uniqueConstraintName="rul_desc_item_spec_code_key"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="shortcut" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="${type.text}">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column type="nvarchar(1000)" name="category"/>
        </createTable>
        
        <!-- rul_item_aptype table -->
        <createTable tableName="rul_item_aptype">
            <column name="item_aptype_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_item_aptype"/>
            </column>
            <column name="ap_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_spec_id" type="int"/>
            <column name="item_type_id" type="int"/>
        </createTable>
        <createIndex indexName="rul_item_spec_register_item_spec_idx" tableName="rul_item_aptype">
            <column name="item_spec_id" type="int"/>
        </createIndex>
        <createIndex indexName="rul_item_aptype_item_type_idx" tableName="rul_item_aptype">
            <column name="item_type_id" type="int"/>
        </createIndex>

        <!-- rul_item_type_action table -->
        <createTable tableName="rul_item_type_action">
            <column name="item_type_action_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="action_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_type_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_itemTypeAction_action"
                                 baseTableName="rul_item_type_action" baseColumnNames="action_id"
                                 referencedTableName="rul_action" referencedColumnNames="action_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_itemType_action"
                                 baseTableName="rul_item_type_action" baseColumnNames="item_type_id"
                                 referencedTableName="rul_item_type" referencedColumnNames="item_type_id" onDelete="NO ACTION"/>

        <!-- rul_arrangement_rule table --> 
        <createTable tableName="rul_arrangement_rule">
            <column name="arrangement_rule_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_arrangement_rule_rule_set"
                             referencedTableName="rul_rule_set"
                             referencedColumnNames="rule_set_id"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_arrangement_rule_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="component_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_arrangement_rule_component"
                             referencedTableName="rul_component"
                             referencedColumnNames="component_id"/>
            </column>
            <column name="rule_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="priority" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- rul_arrangement_extension table -->
        <createTable tableName="rul_arrangement_extension">
            <column name="arrangement_extension_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_arrangement_extension_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_arrangement_extension_rule_set"
                             referencedTableName="rul_rule_set"
                             referencedColumnNames="rule_set_id"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>

        <!-- rul_extension_rule table -->
        <createTable tableName="rul_extension_rule">
            <column name="extension_rule_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="rule_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="priority" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="component_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_extension_rule_component"
                             referencedTableName="rul_component"
                             referencedColumnNames="component_id"/>
            </column>
            <column name="arrangement_extension_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_extension_rule_arrangement_extension"
                             referencedTableName="rul_arrangement_extension"
                             referencedColumnNames="arrangement_extension_id"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_extension_rule_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="compatibility_rul_package" type="int"/>
            <column name="condition" type="nvarchar(250)"/>
        </createTable>

        <!-- arr_data table -->
        <createTable tableName="arr_data">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="data_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="int" defaultValueNumeric="0"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_data_dataType"
                                 baseTableName="arr_data" baseColumnNames="data_type_id"
                                 referencedTableName="rul_data_type" referencedColumnNames="data_type_id" onDelete="NO ACTION"/>

        <!-- arr_change table -->
        <createTable tableName="arr_change">
            <column name="change_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="change_date" type="timestamp with time zone"/>
            <column name="user_id" type="int"/>
            <column name="type" type="char(25)"/>
            <column name="primary_node_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_change_user"
                                 baseTableName="arr_change" baseColumnNames="user_id"
                                 referencedTableName="usr_user" referencedColumnNames="user_id" onDelete="NO ACTION"/>

        <!-- arr_fund table -->
        <createTable tableName="arr_fund">
            <column name="fund_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_finding_aid"/>
            </column>
            <column name="create_date" type="timestamp"/>
            <column name="name" type="nvarchar(255)"/>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="internal_code" type="nvarchar(250)"/>
            <column name="institution_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="fund_number" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="unitdate" type="nvarchar(50)">
                <constraints nullable="true"/>
            </column>
            <column name="mark" type="nvarchar(50)">
                <constraints nullable="true"/>
            </column>
            <column name="managed" type="boolean"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_fund_institution"
                                 baseTableName="arr_fund" baseColumnNames="institution_id"
                                 referencedTableName="par_institution" referencedColumnNames="institution_id" onDelete="NO ACTION"/>

        <!-- arr_fund_register_scope table -->
        <createTable tableName="arr_fund_register_scope">
            <column name="fund_register_scope_id" type="int">
                <constraints primaryKey="true" nullable="false" primaryKeyName="pk_arr_fa_register_scope"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="scope_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="arr_fund_register_scope_fund_scope_idx" tableName="arr_fund_register_scope" unique="true">
            <column name="fund_id" type="int"/>
            <column name="scope_id" type="int"/>
        </createIndex>
        <addForeignKeyConstraint constraintName="fk_faRegScope_findingAid"
                                 baseTableName="arr_fund_register_scope" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_faApScope_scope"
                                 baseTableName="arr_fund_register_scope" baseColumnNames="scope_id" 
                                 referencedTableName="ap_scope" referencedColumnNames="scope_id"/>

        <!-- arr_file table -->
        <createTable tableName="arr_file">
            <column name="file_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints foreignKeyName="fk_arrFile_createChange_arrChange" nullable="false"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_arrFile_deleteChange_arrChange"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arrFile_dmsFile"
                                 baseTableName="arr_file" baseColumnNames="file_id"
                                 referencedTableName="dms_file" referencedColumnNames="file_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arrFile_arrFund"
                                 baseTableName="arr_file" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_fund_version table -->
        <createTable tableName="arr_fund_version">
            <column name="fund_version_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_finding_aid_version"/>
            </column>
            <column name="create_change_id" type="int"/>
            <column name="fund_id" type="int"/>
            <column name="lock_change_id" type="int"/>
            <column name="rule_set_id" type="int"/>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="root_node_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arr_finding_aid_version_1"
                                 baseTableName="arr_fund_version" baseColumnNames="lock_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_finding_aid_version_2"
                                 baseTableName="arr_fund_version" baseColumnNames="rule_set_id"
                                 referencedTableName="rul_rule_set" referencedColumnNames="rule_set_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_finding_aid_version_3"
                                 baseTableName="arr_fund_version" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_finding_aid_version_5"
                                 baseTableName="arr_fund_version" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id" onDelete="NO ACTION"/>

        <!-- arr_node table -->
        <createTable tableName="arr_node">
            <column name="node_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="last_update" type="timestamp"/>
            <column name="uuid" defaultValue="" type="char(36)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_node_fund"
                                 baseTableName="arr_node" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_fundVersion_node"
                                 baseTableName="arr_fund_version" baseColumnNames="root_node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_change_primary_node"
                                 baseTableName="arr_change" baseColumnNames="primary_node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <createIndex tableName="arr_node" indexName="arr_node_fund_idx">
            <column name="fund_id"/>
        </createIndex>

        <!-- arr_cached_node table -->
        <createTable tableName="arr_cached_node">
            <column name="cached_node_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_arr_cached_node_node" referencedTableName="arr_node"
                             referencedColumnNames="node_id"
                             unique="true"/>
            </column>
            <column name="data" type="${type.text}">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex tableName="arr_cached_node" indexName="arr_cached_node_node_idx">
            <column name="node_id"/>
        </createIndex>

        <!-- arr_node_extension table -->
        <createTable tableName="arr_node_extension">
            <column name="node_extension_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_node_extension_create_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_arr_node_extension_delete_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_node_extension_node"
                             referencedTableName="arr_node"
                             referencedColumnNames="node_id"/>
            </column>
            <column name="arrangement_extension_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_node_extension_arrangement_extension"
                             referencedTableName="rul_arrangement_extension"
                             referencedColumnNames="arrangement_extension_id"/>
            </column>
        </createTable>

        <!-- arr_level table -->
        <createTable tableName="arr_level">
            <column name="level_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="create_change_id" type="int"/>
            <column name="delete_change_id" type="int"/>
            <column name="node_id" type="int"/>
            <column name="node_id_parent" type="int"/>
            <column name="position" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_level_node"
                                 baseTableName="arr_level" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_level_node_parent"
                                 baseTableName="arr_level" baseColumnNames="node_id_parent"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_level_1"
                                 baseTableName="arr_level" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_level_2"
                                 baseTableName="arr_level" baseColumnNames="delete_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <createIndex tableName="arr_level" indexName="i_node_id_1">
            <column name="node_id"/>
            <column name="delete_change_id"/>
            <column name="create_change_id"/>
        </createIndex>
        <createIndex tableName="arr_level" indexName="i_node_id_parent_1">
            <column name="node_id_parent"/>
            <column name="delete_change_id"/>
            <column name="create_change_id"/>
        </createIndex>
        <createIndex indexName="arr_level_node_delete_change_idx" tableName="arr_level" unique="true">
            <column name="node_id" type="int"/>
            <column name="delete_change_id" type="int"/>            
        </createIndex>
        <addUniqueConstraint columnNames="create_change_id, node_id" tableName="arr_level"
                                constraintName="arr_level_create_change_node_unqct"/>

        <!-- arr_item table -->
        <createTable tableName="arr_item">
            <column name="item_id" type="int">
                <constraints primaryKeyName="pk_arr_desc_item" primaryKey="true"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="delete_change_id" type="int"/>
            <column name="desc_item_object_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_spec_id" type="int"/>
            <column name="position" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="data_id" type="int"/>
            <column name="read_only" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_descItem_crChange"
                                 baseTableName="arr_item" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_descItem_delChange"
                                 baseTableName="arr_item" baseColumnNames="delete_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_descItem_descItemType"
                                 baseTableName="arr_item" baseColumnNames="item_type_id"
                                 referencedTableName="rul_item_type" referencedColumnNames="item_type_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_descItem_descItemSpec"
                                 baseTableName="arr_item" baseColumnNames="item_spec_id"
                                 referencedTableName="rul_item_spec" referencedColumnNames="item_spec_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_item_data"
                                 baseTableName="arr_item" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>
        <createIndex tableName="arr_item" indexName="arr_item_create_change_idx">
            <column name="create_change_id"/>
        </createIndex>
        <createIndex tableName="arr_item" indexName="arr_item_delete_change_idx">
            <column name="delete_change_id"/>
        </createIndex>
        <createIndex indexName="arr_item_type_idx" tableName="arr_item">
            <column name="item_type_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_item_type_spec_idx" tableName="arr_item">
            <column name="item_type_id" type="int"/>
            <column name="item_spec_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_item_dscitemobj_delchng_idx" tableName="arr_item" unique="true">
            <column name="desc_item_object_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <addUniqueConstraint columnNames="create_change_id, desc_item_object_id" tableName="arr_item"
                             constraintName="arr_item_create_change_obj_unqct"/>

        <!-- arr_desc_item table -->
        <createTable tableName="arr_desc_item">
            <column name="item_id" type="int">
                <constraints primaryKeyName="pk_arr_item" primaryKey="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_descItem_node"
                                 baseTableName="arr_desc_item" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id"
                                 onDelete="NO ACTION"/>
        <createIndex tableName="arr_desc_item" indexName="arr_desc_item_node_idx">
            <column name="node_id"/>
        </createIndex>

        <!-- arr_data_unitdate table -->
        <createTable tableName="arr_data_unitdate">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value_from" type="char(20)">
                <constraints nullable="true"/>
            </column>
            <column name="value_from_estimated" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="value_to" type="char(20)">
                <constraints nullable="true"/>
            </column>
            <column name="value_to_estimated" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="format" defaultValue="" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="normalized_from" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="normalized_to" type="bigint">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- arr_data_string table -->
        <createTable tableName="arr_data_string">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="nvarchar(1000)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataString_data"
                                 baseTableName="arr_data_string" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_unitid table -->
        <createTable tableName="arr_data_unitid">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- arr_data_integer table -->
        <createTable tableName="arr_data_integer">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataInt_data"
                                 baseTableName="arr_data_integer" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_text table -->
        <createTable tableName="arr_data_text">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="${type.text}">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataText_data"
                                 baseTableName="arr_data_text" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_decimal table -->
        <createTable tableName="arr_data_decimal">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="decimal">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataDecimal_data"
                                 baseTableName="arr_data_decimal" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_date table -->
        <createTable tableName="arr_data_date">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="date">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataDate_data"
                                 baseTableName="arr_data_date" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_coordinates table -->
        <createTable tableName="arr_data_coordinates">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="geometry">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataCoordinates_data"
                                 baseTableName="arr_data_coordinates" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_record_ref table -->
        <createTable tableName="arr_data_record_ref">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="record_id" type="int"/>
            <column name="binding_id" type="int"/>
        </createTable>

        <!-- arr_data_file_ref table -->
        <createTable tableName="arr_data_file_ref">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="file_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arr_data_file_ref_arr_data"
                                 baseTableName="arr_data_file_ref" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_data_file_ref_arr_file"
                                 baseTableName="arr_data_file_ref" baseColumnNames="file_id"
                                 referencedTableName="arr_file" referencedColumnNames="file_id" onDelete="NO ACTION"/>

        <!-- arr_data_json_table table -->
        <createTable tableName="arr_data_json_table">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="value" type="${type.text}">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dataJsonTable_data"
                                 baseTableName="arr_data_json_table" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <!-- arr_data_null table -->
        <createTable tableName="arr_data_null">
            <column name="data_id" type="int">
                <constraints primaryKey="true"/>
            </column>
        </createTable>

        <!-- arr_data_bit table -->
        <createTable tableName="arr_data_bit">
            <column name="data_id" type="int">
                <constraints primaryKey="true"
                             foreignKeyName="fk_arr_data_bit"
                             referencedTableName="arr_data"
                             referencedColumnNames="data_id"/>
            </column>
            <column name="value" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- arr_node_conformity table -->
        <createTable tableName="arr_node_conformity">
            <column name="node_conformity_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="fund_version_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="state" type="char(3)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(1000)"/>
            <column name="date" type="timestamp"/>
        </createTable>
        <addUniqueConstraint tableName="arr_node_conformity" columnNames="node_id,fund_version_id" />

        <!-- arr_node_conformity_missing table -->
        <createTable tableName="arr_node_conformity_missing">
            <column name="node_conformity_missing_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_conformity_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_spec_id" type="int"/>
            <column name="description" type="nvarchar(1000)"/>
            <column name="policy_type_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_node_conformity_missing_policy_type"
                                 baseTableName="arr_node_conformity_missing" baseColumnNames="policy_type_id"
                                 referencedTableName="rul_policy_type" referencedColumnNames="policy_type_id" onDelete="NO ACTION"/>

        <!-- arr_node_conformity_error table -->
        <createTable tableName="arr_node_conformity_error">
            <column name="node_conformity_error_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_conformity_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="desc_item_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(1000)"/>
            <column name="policy_type_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_node_conformity_error_policy_type"
                                 baseTableName="arr_node_conformity_error" baseColumnNames="policy_type_id"
                                 referencedTableName="rul_policy_type" referencedColumnNames="policy_type_id" onDelete="NO ACTION"/>

        <!-- arr_bulk_action_run table -->
        <createTable tableName="arr_bulk_action_run">
            <column name="bulk_action_run_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="bulk_action_code" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="fund_version_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="change_id" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="state" type="char(12)">
                <constraints nullable="false"/>
            </column>
            <column name="date_planned" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="date_started" type="timestamp">
                <constraints nullable="true"/>
            </column>
            <column name="date_finished" type="timestamp">
                <constraints nullable="true"/>
            </column>
            <column name="error" type="nvarchar(1000)">
                <constraints nullable="true"/>
            </column>
            <column name="result" type="${type.text}"/>
            <column name="config" type="${type.text}"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arrFaBulkAction_faVersion"
                                 baseTableName="arr_bulk_action_run" baseColumnNames="fund_version_id"
                                 referencedTableName="arr_fund_version"
                                 referencedColumnNames="fund_version_id" onDelete="NO ACTION"/>

        <!-- arr_bulk_action_node table -->
        <createTable tableName="arr_bulk_action_node">
            <column name="bulk_action_node_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="bulk_action_run_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_bulk_action_node_bulk_action_run"
                                 baseTableName="arr_bulk_action_node" baseColumnNames="bulk_action_run_id"
                                 referencedTableName="arr_bulk_action_run" referencedColumnNames="bulk_action_run_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_bulk_action_node_node"
                                 baseTableName="arr_bulk_action_node" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_output table -->
        <createTable tableName="arr_output">
            <column name="output_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_output"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="output_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="state" type="char(12)">
                <constraints nullable="false"/>
            </column>
            <column type="text" name="error">
                <constraints nullable="true"/>
            </column>
            <column name="internal_code" type="nvarchar(250)"/>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="last_update" type="timestamp"/>
            <column name="output_settings" type="text"/>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="delete_change_id" type="int"/>
            <column name="anonymized_ap_id" type="int"/>
            <column name="output_filter_id" type="int"/>
        </createTable>
        <createIndex indexName="arr_output_fund_idx" tableName="arr_output">
            <column name="fund_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_output_create_change_idx" tableName="arr_output">
            <column name="create_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_output_delete_change_idx" tableName="arr_output">
            <column name="delete_change_id" type="int"/>
        </createIndex>

        <!-- arr_node_output table -->
        <createTable tableName="arr_node_output">
            <column name="node_output_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="output_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="delete_change_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_node_output_node"
                                 baseTableName="arr_node_output" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_node_output_create_change"
                                 baseTableName="arr_node_output" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_node_output_delete_change"
                                 baseTableName="arr_node_output" baseColumnNames="delete_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_node_output"
                                 baseTableName="arr_node_output" baseColumnNames="output_id"
                                 referencedTableName="arr_output" referencedColumnNames="output_id"/>

        <!-- arr_output_item table -->
        <createTable tableName="arr_output_item">
            <column name="item_id" type="int">
                <constraints primaryKeyName="pk_arr_output_item" primaryKey="true"/>
            </column>
            <column name="output_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="arr_output_item_output_idx" tableName="arr_output_item">
            <column name="output_id" type="int"/>
        </createIndex>
        <addForeignKeyConstraint constraintName="fk_arr_output_item_output"
                                 baseTableName="arr_output_item" baseColumnNames="output_id"
                                 referencedTableName="arr_output" referencedColumnNames="output_id"/>

        <!-- arr_output_result table -->
        <createTable tableName="arr_output_result">
            <column name="output_result_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="output_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="template_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="change_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="arr_output_result_output_idx" tableName="arr_output_result">
            <column name="output_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_output_result_chnage_idx" tableName="arr_output_result">
            <column name="change_id" type="int"/>
        </createIndex>
        <addForeignKeyConstraint constraintName="fk_arrOutputResult_rulTemplate"
                                 baseTableName="arr_output_result" baseColumnNames="template_id"
                                 referencedTableName="rul_template" referencedColumnNames="template_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arrOutputResult_arrChange"
                                 baseTableName="arr_output_result" baseColumnNames="change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_output_result_output"
                                 baseTableName="arr_output_result" baseColumnNames="output_id"
                                 referencedTableName="arr_output" referencedColumnNames="output_id"/>

        <!-- arr_output_file table -->
        <createTable tableName="arr_output_file">
            <column name="file_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="output_result_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="arr_output_file_result_idx" tableName="arr_output_file">
            <column name="output_result_id" type="int"/>
        </createIndex>
        <addForeignKeyConstraint constraintName="fk_arrOutputFile_dmsFile"
                                 baseTableName="arr_output_file" baseColumnNames="file_id"
                                 referencedTableName="dms_file" referencedColumnNames="file_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arrOutputFile_arrOutputResult"
                                 baseTableName="arr_output_file" baseColumnNames="output_result_id"
                                 referencedTableName="arr_output_result" referencedColumnNames="output_result_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_item_settings table -->
        <createTable tableName="arr_item_settings">
            <column name="item_settings_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="item_type_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="output_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="block_action_result" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_itemSettings_item_type"
                                 baseTableName="arr_item_settings" baseColumnNames="item_type_id"
                                 referencedTableName="rul_item_type" referencedColumnNames="item_type_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_item_settings_output"
                                 baseTableName="arr_item_settings" baseColumnNames="output_id"
                                 referencedTableName="arr_output" referencedColumnNames="output_id"/>

        <!-- ui_visible_policy table -->
        <createTable tableName="ui_visible_policy">
            <column name="visible_policy_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="visible" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="policy_type_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_visible_policy_node"
                                 baseTableName="ui_visible_policy" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_visible_policy_policy_type"
                                 baseTableName="ui_visible_policy" baseColumnNames="policy_type_id"
                                 referencedTableName="rul_policy_type" referencedColumnNames="policy_type_id"
                                 onDelete="NO ACTION"/>

        <!-- ui_settings table -->
        <createTable tableName="ui_settings">
            <column name="settings_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="user_id" type="int"/>
            <column name="settings_type" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="entity_type" type="nvarchar(250)"/>
            <column name="entity_id" type="int"/>
            <column name="value" type="${type.text}"/>
            <column name="package_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_settings_user"
                                 baseTableName="ui_settings" baseColumnNames="user_id"
                                 referencedTableName="usr_user" referencedColumnNames="user_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_ui_settings_package"
                                 baseTableName="ui_settings" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>

        <!-- usr_permission table -->
        <createTable tableName="usr_permission">
            <column name="permission_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="permission" type="char(50)">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="int"/>
            <column name="group_id" type="int"/>
            <column name="fund_id" type="int"/>
            <column name="scope_id" type="int"/>
            <column name="user_control_id" type="int"/>
            <column name="group_control_id" type="int"/>
            <column name="issue_list_id" type="int"/>
            <column name="node_id" type="int">
                <constraints foreignKeyName="fk_usr_permission_node" referencedTableName="arr_node" referencedColumnNames="node_id"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_permission_user"
                                 baseTableName="usr_permission" baseColumnNames="user_id"
                                 referencedTableName="usr_user" referencedColumnNames="user_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_permission_group"
                                 baseTableName="usr_permission" baseColumnNames="group_id"
                                 referencedTableName="usr_group" referencedColumnNames="group_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_permission_fund"
                                 baseTableName="usr_permission" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_permission_scope"
                                 baseTableName="usr_permission" baseColumnNames="scope_id" 
                                 referencedTableName="ap_scope" referencedColumnNames="scope_id"/>
        <addForeignKeyConstraint constraintName="fk_permission_user_control"
                                 baseTableName="usr_permission" baseColumnNames="user_control_id"
                                 referencedTableName="usr_user" referencedColumnNames="user_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_permission_group_control"
                                 baseTableName="usr_permission" baseColumnNames="group_control_id"
                                 referencedTableName="usr_group" referencedColumnNames="group_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_digital_repository table -->
        <createTable tableName="arr_digital_repository">
            <column name="external_system_id" type="int">
                <constraints primaryKey="true" nullable="false" foreignKeyName="fk_arr_digital_repository" 
                             referencedTableName="sys_external_system" referencedColumnNames="external_system_id"/>
            </column>
            <column name="view_dao_url" type="nvarchar(1000)"/>
            <column name="view_file_url" type="nvarchar(1000)"/>
            <column name="send_notification" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="view_thumbnail_url" type="nvarchar(1000)"/>
        </createTable>

        <!-- arr_digitization_frontdesk table -->
        <createTable tableName="arr_digitization_frontdesk">
            <column name="external_system_id" type="int">
                <constraints primaryKey="true" nullable="false" foreignKeyName="fk_arr_digitization_frontdesk" 
                             referencedTableName="sys_external_system" referencedColumnNames="external_system_id"/>
            </column>
        </createTable>

        <!-- arr_dao_batch_info table -->
        <createTable tableName="arr_dao_batch_info">
            <column name="dao_batch_info_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="code" type="nvarchar(1000)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="label" type="nvarchar(250)"/>
        </createTable>

        <!-- arr_dao_package table -->
        <createTable tableName="arr_dao_package">
            <column name="dao_package_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="digital_repository_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="dao_batch_info_id" type="int"/>
            <column name="code" type="nvarchar(1000)" >
                <constraints unique="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_package_digital_repository"
                                 baseTableName="arr_dao_package" baseColumnNames="digital_repository_id"
                                 referencedTableName="arr_digital_repository" referencedColumnNames="external_system_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_package_fund"
                                 baseTableName="arr_dao_package" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_package_dao_batch_info"
                                 baseTableName="arr_dao_package" baseColumnNames="dao_batch_info_id"
                                 referencedTableName="arr_dao_batch_info" referencedColumnNames="dao_batch_info_id" onDelete="NO ACTION"/>

        <!-- arr_dao table -->
        <createTable tableName="arr_dao">
            <column name="dao_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="dao_package_id" type="int">
                <constraints nullable="true"/>
            </column>
            <column name="valid" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="label" type="nvarchar(250)"/>
            <column name="dao_type" type="nvarchar(25)">
                <constraints nullable="false"/>
            </column>
            <column name="attributes" type="text"/>
            <column name="code" type="nvarchar(1000)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_dao_package"
                                 baseTableName="arr_dao" baseColumnNames="dao_package_id"
                                 referencedTableName="arr_dao_package" referencedColumnNames="dao_package_id" onDelete="NO ACTION"/>

        <!-- arr_dao_link table -->
        <createTable tableName="arr_dao_link">
            <column name="dao_link_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="dao_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="delete_change_id" type="int"/>
            <column name="scenario" type="nvarchar(250)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_link_dao"
                                 baseTableName="arr_dao_link" baseColumnNames="dao_id"
                                 referencedTableName="arr_dao" referencedColumnNames="dao_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_link_node"
                                 baseTableName="arr_dao_link" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_link_create_change"
                                 baseTableName="arr_dao_link" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_link_delete_change"
                                 baseTableName="arr_dao_link" baseColumnNames="delete_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>

        <!-- arr_dao_file_group table -->
        <createTable tableName="arr_dao_file_group">
            <column name="dao_file_group_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="dao_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="label" type="nvarchar(250)"/>
            <column name="code" type="nvarchar(1000)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_file_group_dao"
                                 baseTableName="arr_dao_file_group" baseColumnNames="dao_id"
                                 referencedTableName="arr_dao" referencedColumnNames="dao_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_dao_file table -->
        <createTable tableName="arr_dao_file">
            <column name="dao_file_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="dao_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="dao_file_group_id" type="int"/>
            <column name="checksum" type="nvarchar(250)"/>
            <column name="checksum_type" type="char(10)"/>
            <column name="created" type="timestamp"/>
            <column name="mimetype" type="nvarchar(50)"/>
            <column name="size" type="bigint"/>
            <column name="image_height" type="int"/>
            <column name="image_width" type="int"/>
            <column name="source_x_dimension_unit" type="char(10)"/>
            <column name="source_x_dimension_value" type="decimal"/>
            <column name="source_y_dimension_unit" type="char(10)"/>
            <column name="source_y_dimension_value" type="decimal"/>
            <column name="duration" type="nvarchar(250)"/>
            <column name="description" type="nvarchar(2000)"/>
            <column name="file_name" type="nvarchar(1000)"/>
            <column name="code" type="nvarchar(1000)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_file_dao"
                                 baseTableName="arr_dao_file" baseColumnNames="dao_id"
                                 referencedTableName="arr_dao" referencedColumnNames="dao_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_file_dao_file_group"
                                 baseTableName="arr_dao_file" baseColumnNames="dao_file_group_id"
                                 referencedTableName="arr_dao_file_group" referencedColumnNames="dao_file_group_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_request table -->
        <createTable tableName="arr_request">
            <column name="request_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(1000)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="state" type="char(20)">
                <constraints nullable="false"/>
            </column>
            <column name="response_external_system" type="timestamp"/>
            <column name="reject_reason" type="nvarchar(1000)"/>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="discriminator" type="nvarchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="external_system_code" type="nvarchar(1000)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_request_fund"
                                 baseTableName="arr_request" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_request_change"
                                 baseTableName="arr_request" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_dao_request table -->
        <createTable tableName="arr_dao_request">
            <column name="request_id" type="int">
                <constraints primaryKey="true" foreignKeyName="fk_dao_request_request" 
                             referencedTableName="arr_request" referencedColumnNames="request_id"/>
            </column>
            <column name="type" type="char(20)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(1000)"/>
            <column name="digital_repository_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_request_digital_repository"
                                 baseTableName="arr_dao_request" baseColumnNames="digital_repository_id"
                                 referencedTableName="arr_digital_repository" referencedColumnNames="external_system_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_digitization_request table -->
        <createTable tableName="arr_digitization_request">
            <column name="request_id" type="int">
                <constraints primaryKey="true" foreignKeyName="fk_digitization_request_request" 
                             referencedTableName="arr_request" referencedColumnNames="request_id"/>
            </column>
            <column name="digitization_frontdesk_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(1000)"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_digitization_request_digitization_frontdesk"
                                 baseTableName="arr_digitization_request" baseColumnNames="digitization_frontdesk_id"
                                 referencedTableName="arr_digitization_frontdesk" referencedColumnNames="external_system_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_dao_link_request table -->
        <createTable tableName="arr_dao_link_request">
            <column name="request_id" type="int">
                <constraints primaryKey="true" foreignKeyName="fk_dao_link_request_request" 
                             referencedTableName="arr_request" referencedColumnNames="request_id"/>
            </column>
            <column name="dao_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="digital_repository_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="char(20)">
                <constraints nullable="false"/>
            </column>
            <column name="did_code" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_link_request_dao"
                                 baseTableName="arr_dao_link_request" baseColumnNames="dao_id" 
                                 referencedTableName="arr_dao" referencedColumnNames="dao_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_link_request_digital_repository"
                                 baseTableName="arr_dao_link_request" baseColumnNames="digital_repository_id"
                                 referencedTableName="arr_digital_repository" referencedColumnNames="external_system_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_dao_request_dao table -->
        <createTable tableName="arr_dao_request_dao">
            <column name="dao_request_dao_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="dao_request_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="dao_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_dao_request_dao_dao_request"
                                 baseTableName="arr_dao_request_dao" baseColumnNames="dao_request_id"
                                 referencedTableName="arr_dao_request" referencedColumnNames="request_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_dao_request_dao_dao"
                                 baseTableName="arr_dao_request_dao" baseColumnNames="dao_id"
                                 referencedTableName="arr_dao" referencedColumnNames="dao_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_digitization_request_node table -->
        <createTable tableName="arr_digitization_request_node">
            <column name="digitization_request_node_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="digitization_request_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="node_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_digitization_request_node_digitization_request"
                                 baseTableName="arr_digitization_request_node" baseColumnNames="digitization_request_id"
                                 referencedTableName="arr_digitization_request" referencedColumnNames="request_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_digitization_request_node_node"
                                 baseTableName="arr_digitization_request_node" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_request_queue_item table -->
        <createTable tableName="arr_request_queue_item">
            <column name="request_queue_item_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="request_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="attempt_to_send" type="timestamp"/>
            <column name="error" type="nvarchar(1000)"/>
            <column name="send" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="data" type="${type.text}"/>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_request_queue_item_request"
                                 baseTableName="arr_request_queue_item" baseColumnNames="request_id"
                                 referencedTableName="arr_request" referencedColumnNames="request_id"
                                 onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_request_queue_item_change"
                                 baseTableName="arr_request_queue_item" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_fund_structure_extension table -->
        <createTable tableName="arr_fund_structure_extension">
            <column name="fund_structure_extension_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_fund_structure_extension_create_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_arr_fund_structure_extension_delete_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_fund_structure_extension_fund"
                             referencedTableName="arr_fund"
                             referencedColumnNames="fund_id"/>
            </column>
            <column name="structured_type_extension_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_fund_structure_extension_structure_extension"
                             referencedTableName="rul_structured_type_extension"
                             referencedColumnNames="structured_type_extension_id"/>
            </column>
        </createTable>

        <!-- arr_structured_object table -->
        <createTable tableName="arr_structured_object">
            <column name="structured_object_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_structure_data"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_structure_data_create_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_arr_structure_data_delete_change"
                             referencedTableName="arr_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="structured_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_structure_data_structure_type"
                             referencedTableName="rul_structured_type"
                             referencedColumnNames="structured_type_id"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_structure_data_fund"
                             referencedTableName="arr_fund"
                             referencedColumnNames="fund_id"/>
            </column>
            <column name="value" type="nvarchar(1000)"/>
            <column name="assignable" type="boolean">
                <constraints nullable="false"/>
            </column>
            <column name="state" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="error_description" type="${type.text}"/>
            <column name="sort_value" type="nvarchar(1000)"/>
            <column name="complement" type="nvarchar(1000)"/>
            <column name="uuid" type="char(36)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="arr_structured_object" constraintName="arr_structured_object_uuid_unique" 
                             columnNames="uuid, fund_id, structured_type_id, delete_change_id"/>  
        <createIndex tableName="arr_structured_object" indexName="arr_structured_object_sort_idx">
            <column name="sort_value"/>
        </createIndex>
        <createIndex indexName="arr_structured_object_uuid_idx" tableName="arr_structured_object" unique="false">
            <column name="uuid" type="char(36)"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>

        <!-- arr_sobj_vrequest table -->
        <createTable tableName="arr_sobj_vrequest">
            <column name="sobj_vrequest_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="structured_object_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arr_sobj_vrequest_structured_object"
                                 baseTableName="arr_sobj_vrequest" baseColumnNames="structured_object_id"
                                 referencedTableName="arr_structured_object" referencedColumnNames="structured_object_id"
                                 onDelete="NO ACTION"/>

        <!-- arr_structured_item table -->
        <createTable tableName="arr_structured_item">
            <column name="item_id" type="int">
                <constraints primaryKeyName="pk_arr_structure_item" primaryKey="true"/>
            </column>
            <column name="structured_object_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_structure_item_structure_data"
                             referencedTableName="arr_structured_object"
                             referencedColumnNames="structured_object_id"/>
            </column>
        </createTable>

        <!-- arr_data_structure_ref table -->
        <createTable tableName="arr_data_structure_ref">
            <column name="data_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="structured_object_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_data_structure_ref_structure_data"
                             referencedTableName="arr_structured_object"
                             referencedColumnNames="structured_object_id"/>
            </column>
        </createTable>

        <!-- arr_locked_value table -->
        <createTable tableName="arr_locked_value">
            <column name="locked_value_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_used_value"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="item_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_arr_locked_value_fund"
                                 baseTableName="arr_locked_value" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_locked_value_item"
                                 baseTableName="arr_locked_value" baseColumnNames="item_id"
                                 referencedTableName="arr_item" referencedColumnNames="item_id" onDelete="NO ACTION"/>
        <addForeignKeyConstraint constraintName="fk_arr_locked_value_create_change"
                                 baseTableName="arr_locked_value" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id" onDelete="NO ACTION"/>
        <createIndex tableName="arr_locked_value" indexName="arr_locked_value_fund_idx">
            <column name="fund_id"/>
        </createIndex>
        <createIndex tableName="arr_locked_value" indexName="arr_locked_value_item_idx">
            <column name="item_id"/>
        </createIndex>

        <!-- sys_index_work table -->
        <createTable tableName="sys_index_work">
            <column name="index_work_id" type="bigint">
                <constraints primaryKey="true" primaryKeyName="pk_sys_index_work"/>
            </column>
            <column name="index_name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="entity_class" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="entity_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="insert_time" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="start_time" type="timestamp"/>
        </createTable>

        <!-- wf_issue_state table -->
        <createTable tableName="wf_issue_state">
            <column name="issue_state_id" type="integer">
                <constraints primaryKey="true" primaryKeyName="pk_wf_issue_state"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="start_state" type="boolean" defaultValue="false" remarks="Flag if state is start state. Only one state can be marked as start state.">
                <constraints nullable="false"/>
            </column>
            <column name="final_state" type="boolean" defaultValue="false" remarks="Flag if state is final. There might be several final states.">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_issue_state_package" referencedTableName="rul_package" referencedColumnNames="package_id"/>
            </column>
        </createTable>

        <!-- wf_issue_type table -->
        <createTable tableName="wf_issue_type">
            <column name="issue_type_id" type="integer">
                <constraints primaryKey="true" primaryKeyName="pk_wf_issue_type"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="view_order" type="integer">
                <constraints nullable="false"/>
            </column>
            <column name="package_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_issue_type_package" referencedTableName="rul_package" referencedColumnNames="package_id"/>
            </column>
        </createTable>

        <!-- wf_issue_list table -->
        <createTable tableName="wf_issue_list">
            <column name="issue_list_id" type="integer" remarks="Identificator of issue list">
                <constraints primaryKey="true" primaryKeyName="pk_wf_issue_list"/>
            </column>
            <column name="fund_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_issue_list_fund" referencedTableName="arr_fund" referencedColumnNames="fund_id"/>
            </column>
            <column name="open" type="boolean" remarks="Flag if list is open for new issues">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="nvarchar(250)" remarks="Name of list">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- wf_issue table -->
        <createTable tableName="wf_issue">
            <column name="issue_id" type="integer" remarks="ID of issue">
                <constraints primaryKey="true" primaryKeyName="pk_wf_issue"/>
            </column>
            <column name="issue_list_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_issue_list" referencedTableName="wf_issue_list" referencedColumnNames="issue_list_id"/>
            </column>
            <column name="number" type="integer">
                <constraints nullable="false"/>
            </column>
            <column name="node_id" type="integer">
                <constraints nullable="true" foreignKeyName="fk_issue_node" referencedTableName="arr_node" referencedColumnNames="node_id"/>
            </column>
            <column name="issue_type_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_issue_type" referencedTableName="wf_issue_type" referencedColumnNames="issue_type_id"/>
            </column>
            <column name="issue_state_id" type="integer" remarks="Current state of the issue">
                <constraints nullable="false" foreignKeyName="fk_issue_state" referencedTableName="wf_issue_state" referencedColumnNames="issue_state_id"/>
            </column>
            <column name="description" type="${type.text}" remarks="Description of the issue">
                <constraints nullable="false"/>
            </column>
            <column name="user_create_id" type="integer" remarks="ID of user who created the issue">
                <constraints nullable="false" foreignKeyName="fk_wf_issue_usr_user" referencedTableName="usr_user" referencedColumnNames="user_id"/>
            </column>
            <column name="time_created" type="timestamp" remarks="Time when issue was created">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- wf_comment table -->
        <createTable tableName="wf_comment">
            <column name="comment_id" type="integer" remarks="ID of comment">
                <constraints primaryKey="true" primaryKeyName="pk_wf_comment"/>
            </column>
            <column name="issue_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_wf_comment_wf_issue" referencedTableName="wf_issue" referencedColumnNames="issue_id"/>
            </column>
            <column name="comment" type="${type.text}">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_comment_user" referencedTableName="usr_user" referencedColumnNames="user_id"/>
            </column>
            <column name="prev_state_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_comment_prev_state" referencedTableName="wf_issue_state" referencedColumnNames="issue_state_id"/>
            </column>
            <column name="next_state_id" type="integer">
                <constraints nullable="false" foreignKeyName="fk_comment_next_state" referencedTableName="wf_issue_state" referencedColumnNames="issue_state_id"/>
            </column>
            <column name="time_created" type="timestamp">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- usr_authentication table -->
        <createTable tableName="usr_authentication">
            <column name="authentication_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="user_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_usr_authentication_user"
                             referencedTableName="usr_user"
                             referencedColumnNames="user_id"/>
            </column>
            <column name="auth_type" type="char(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- ap_scope_relation table -->
        <createTable tableName="ap_scope_relation">
            <column name="scope_relation_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="scope_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_scope"
                             referencedTableName="ap_scope"
                             referencedColumnNames="scope_id"/>
            </column>
            <column name="connected_scope_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_connected_scope"
                             referencedTableName="ap_scope"
                             referencedColumnNames="scope_id"/>
            </column>
        </createTable>

        <!-- arr_data_uri_ref table -->
        <createTable tableName="arr_data_uri_ref">
            <column name="data_id" type="int">
                <constraints primaryKey="true"
                             foreignKeyName="fk_arr_data_uri_ref_data"
                             referencedTableName="arr_data"
                             referencedColumnNames="data_id"/>
            </column>
            <column name="schema" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="nvarchar(2000)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="nvarchar(2000)">
                <constraints nullable="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints foreignKeyName="fk_arr_node_id" referencedTableName="arr_node" referencedColumnNames="node_id" nullable="true"/>
            </column>
            <column name="ref_template_id" type="int"/>
        </createTable>
        <createIndex indexName="arr_data_uri_ref_node_idx" tableName="arr_data_uri_ref" unique="false">
            <column name="node_id" type="int"/>
        </createIndex>

        <!-- arr_async_request table -->
        <createTable tableName="arr_async_request">
            <column name="async_request_id" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="type" type="nvarchar(10)">
                <constraints nullable="false"/>
            </column>
            <column name="priority" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="fund_version_id" type="int">
                <constraints foreignKeyName="fk_arr_async_fund_version_id"  referencedTableName="arr_fund_version" referencedColumnNames="fund_version_id" nullable="true"/>
            </column>
            <column name="node_id" type="int">
                <constraints foreignKeyName="fk_arr_async_node_id" referencedTableName="arr_node" referencedColumnNames="node_id" nullable="true"/>
            </column>
            <column name="output_id" type="int">
                <constraints foreignKeyName="fk_ar_asyncr_output_id" referencedTableName="arr_output" referencedColumnNames="output_id" nullable="true"/>
            </column>
            <column name="bulk_action_id" type="int">
                <constraints foreignKeyName="fk_arr_async_bulk_action_id" referencedTableName="arr_bulk_action_run" referencedColumnNames="bulk_action_run_id" nullable="true"/>
            </column>
            <column name="structured_object_id" type="int">
                <constraints foreignKeyName="fk_arr_async_structured_object_id" referencedTableName="arr_structured_object" referencedColumnNames="structured_object_id" nullable="true"/>
            </column>
            <column name="user_id" type="int"/>
            <column name="access_point_id" type="int"/>
        </createTable>

        <!-- arr_output_restriction_scope table -->
        <createTable tableName="arr_output_restriction_scope">
            <column name="restriction_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_output_restriction_scope"/>
            </column>
            <column name="output_id" type = "int">
                <constraints nullable="false"
                             foreignKeyName="fk_restricted_output"
                             referencedTableName="arr_output"
                             referencedColumnNames="output_id"/>
            </column>
            <column name="scope_id" type = "int">
                <constraints nullable="false"
                             foreignKeyName="fk_restricted_socpe"
                             referencedTableName="ap_scope"
                             referencedColumnNames="scope_id"/>
            </column>
        </createTable>

        <!-- rul_item_type_spec_assign table -->
        <createTable tableName="rul_item_type_spec_assign">
            <column name="item_type_spec_assign_id" type="INTEGER">
                <constraints primaryKey="true" primaryKeyName="PK_rul_item_type_spec_assign"/>
            </column>
            <column name="item_type_id" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="item_spec_id" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="item_spec_view_order" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="IXFK_rul_item_type_spec_assign_rul_item_spec" tableName="rul_item_type_spec_assign">
            <column name="item_spec_id"/>
        </createIndex>
        <createIndex indexName="IXFK_rul_item_type_spec_assign_rul_item_type" tableName="rul_item_type_spec_assign">
            <column name="item_type_id"/>
        </createIndex>
        <addForeignKeyConstraint baseColumnNames="item_spec_id" baseTableName="rul_item_type_spec_assign"
                                 constraintName="FK_rul_item_type_spec_assign_rul_item_spec_02" deferrable="false"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="item_spec_id" referencedTableName="rul_item_spec"/>
        <addForeignKeyConstraint baseColumnNames="item_type_id" baseTableName="rul_item_type_spec_assign"
                                 constraintName="FK_rul_item_type_spec_assign_rul_item_type_02" deferrable="false"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="item_type_id" referencedTableName="rul_item_type"/>

        <!-- rul_part_type table -->
        <createTable tableName="rul_part_type">
            <column name="part_type_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_rul_part_type"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_rul_part_type_rul_package"
                             referencedTableName="rul_package"
                             referencedColumnNames="package_id"/>
            </column>
            <column name="name" type="nvarchar(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="child_part_id" type="int">
                <constraints foreignKeyName="fk_rul_part_type_child"
                             referencedTableName="rul_part_type"
                             referencedColumnNames="part_type_id"/>
            </column>
            <column name="repeatable" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>

         <!-- ap_part table -->
        <createTable tableName="ap_part">
            <column name="part_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="error_description" type="${type.text}"/>
            <column name="state" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="part_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_part_rul_part_type"
                             referencedTableName="rul_part_type"
                             referencedColumnNames="part_type_id"/>
            </column>
            <column name="parent_part_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_part_parent_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="access_point_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_part_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_part_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="key_value_id" type="int"/>
            <column name="last_change_id" type="int">
                <constraints foreignKeyName="fk_ap_part_last_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id" nullable="false"/>
            </column>
        </createTable>

        <!-- ap_item table -->
        <createTable tableName="ap_item">
            <column name="item_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="data_id" type="int">
                <constraints foreignKeyName="fk_ap_item_data"
                             referencedTableName="arr_data"
                             referencedColumnNames="data_id"/>
            </column>
            <column name="item_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_item_item_type"
                             referencedTableName="rul_item_type"
                             referencedColumnNames="item_type_id"/>
            </column>
            <column name="item_spec_id" type="int">
                <constraints foreignKeyName="fk_ap_item_item_spec"
                             referencedTableName="rul_item_spec"
                             referencedColumnNames="item_spec_id"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_item_item_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_ap_item_item_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="object_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="position" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="part_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_item_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
        </createTable>

        <!-- ap_access_point table --> 
        <createTable tableName="ap_access_point">
            <column name="access_point_id" type="int">
                <constraints primaryKey="true" nullable="false" primaryKeyName="pk_ap_record"/>
            </column>
            <column name="uuid" type="char(36)">
                <constraints nullable="false" unique="true" uniqueConstraintName="uq_reg_record_uuid"/>
            </column>
            <column name="error_description" type="${type.text}"/>
            <column name="state" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="int" defaultValueNumeric="0"/>
            <column name="last_update" type="timestamp">
                <constraints nullable="false"/>
            </column>
            <column name="preferred_part_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_access_point_preferred_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
        </createTable>
        <createIndex indexName="ap_last_update_idx" tableName="ap_access_point" unique="false">
            <column name="last_update" type="timestamp"/>
        </createIndex>        

        <!-- ap_state table -->
        <createTable tableName="ap_state">
            <column name="state_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="access_point_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap"
                             referencedTableName="ap_access_point"
                             referencedColumnNames="access_point_id"/>
            </column>
            <column name="scope_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_scope"
                             referencedTableName="ap_scope"
                             referencedColumnNames="scope_id"/>
            </column>
            <column name="ap_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_type"
                             referencedTableName="ap_type"
                             referencedColumnNames="ap_type_id"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_change_create"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_change_delete"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
			</column>
            <column name="state_approval" type="char(50)">
                <constraints nullable="false"/>
            </column>
            <column name="comment" type="text">
                <constraints nullable="true"/>
            </column>
            <column name="replaced_by" type="int">
                <constraints foreignKeyName="fk_ar_state_replaced_by"
                             referencedTableName="ap_access_point"
                             referencedColumnNames="access_point_id"
                             nullable="true"/>
            </column>
        </createTable>
        <createIndex indexName="ap_state_replaced_by_idx" tableName="ap_state" unique="false">
            <column name="replaced_by" type="int"/>
        </createIndex>

        <!-- ap_binding table -->
        <createTable tableName="ap_binding">
            <column name="binding_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="value" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="external_system_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_binding_external_system"
                             referencedTableName="ap_external_system"
                             referencedColumnNames="external_system_id"/>
            </column>
        </createTable>
        <createIndex indexName="ap_binding_value_system_idx" tableName="ap_binding" unique="true">
            <column name="value" type="nvarchar(50)"/>
            <column name="external_system_id" type="int"/>
        </createIndex>

        <!-- ap_binding_state table -->
        <createTable tableName="ap_binding_state">
            <column name="binding_state_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_binding_state"/>
            </column>
            <column name="binding_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_binding_state_binding"
                             referencedTableName="ap_binding"
                             referencedColumnNames="binding_id"/>
            </column>
            <column name="access_point_id" type="int">
                <constraints foreignKeyName="fk_ap_binding_state_access_point"
                             referencedTableName="ap_access_point"
                             referencedColumnNames="access_point_id"/>
            </column>
            <column name="ext_state" type="nvarchar(50)"/>
            <column name="ext_revision" type="nvarchar(50)"/>
            <column name="ext_user" type="nvarchar(250)"/>
            <column name="ext_replaced_by" type="nvarchar(50)"/>
            <column name="sync_change_id" type="int">
                <constraints foreignKeyName="fk_ap_binding_state_sync_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="sync_ok" type="nvarchar(10)"/>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_binding_state_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_ap_binding_state_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="external_system_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="preferred_part_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_binding_state_preferred_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="ap_type_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_binding_state_ap_type"
                             referencedTableName="ap_type"
                             referencedColumnNames="ap_type_id"/>
            </column>
        </createTable>

        <!-- ap_binding_item table -->
        <createTable tableName="ap_binding_item">
            <column name="binding_item_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_binding_item"/>
            </column>
            <column name="binding_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_binding_item_binding"
                             referencedTableName="ap_binding"
                             referencedColumnNames="binding_id"/>
            </column>
            <column name="value" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="part_id" type="int"/>
            <column name="item_id" type="int"/>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_binding_item_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_binding_item_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
        </createTable>
        <createIndex indexName="ap_binding_item_id_idx" tableName="ap_binding_item">
            <column name="binding_id"/>
        </createIndex>
        <createIndex indexName="ap_binding_item_value_idx" tableName="ap_binding_item" unique="false">
            <column name="value" type="nvarchar(50)"/>
            <column name="binding_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_binding_item_part_idx" tableName="ap_binding_item" unique="false">
            <column name="part_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_binding_item_item_idx" tableName="ap_binding_item" unique="false">
            <column name="item_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>

        <!-- arr_ref_template table -->
        <createTable tableName="arr_ref_template">
            <column name="ref_template_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_ref_template"/>
            </column>
            <column name="fund_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_ref_template_fund"
                             referencedTableName="arr_fund"
                             referencedColumnNames="fund_id"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="item_node_ref_id" type="int">
                <constraints foreignKeyName="fk_arr_ref_template_item_node_ref"
                             referencedTableName="rul_item_type"
                             referencedColumnNames="item_type_id"/>
            </column>
        </createTable>

        <!-- arr_ref_template_map_type table -->
        <createTable tableName="arr_ref_template_map_type">
            <column name="ref_template_map_type_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_ref_template_map_type"/>
            </column>
            <column name="ref_template_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_ref_template_map_type_ref_template"
                             referencedTableName="arr_ref_template"
                             referencedColumnNames="ref_template_id"/>
            </column>
            <column name="from_item_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_ref_template_from_item_type"
                             referencedTableName="rul_item_type"
                             referencedColumnNames="item_type_id"/>
            </column>
            <column name="to_item_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_ref_template_to_item_type"
                             referencedTableName="rul_item_type"
                             referencedColumnNames="item_type_id"/>
            </column>
            <column name="from_parent_level" type="boolean"/>
            <column name="map_all_spec" type="boolean"/>
        </createTable>

        <!-- arr_ref_template_map_spec table -->
        <createTable tableName="arr_ref_template_map_spec">
            <column name="ref_template_map_spec_id" type="int">
                <constraints primaryKey="true" primaryKeyName="PK_ref_template_map_spec"/>
            </column>
            <column name="ref_template_map_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_arr_ref_template_map_spec_ref_template_map_type"
                             referencedTableName="arr_ref_template_map_type"
                             referencedColumnNames="ref_template_map_type_id"/>
            </column>
            <column name="from_item_spec_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_arr_ref_template_map_spec_from_item_spec"
                             referencedTableName="rul_item_spec"
                             referencedColumnNames="item_spec_id"/>
            </column>
            <column name="to_item_spec_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_arr_ref_template_map_spec_to_item_spec"
                             referencedTableName="rul_item_spec"
                             referencedColumnNames="item_spec_id"/>
            </column>
        </createTable>

        <!-- arr_output_template table -->
        <createTable tableName="arr_output_template">
            <column name="output_template_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_arr_output_template"/>
            </column>
            <column name="output_id" type="int">
                <constraints foreignKeyName="fk_arr_output_template_output_id" 
                             referencedTableName="arr_output"
                             referencedColumnNames="output_id"/>
            </column>
            <column name="template_id" type="int">
                <constraints foreignKeyName="fk_arr_output_template_template_id" 
                             referencedTableName="rul_template"
                             referencedColumnNames="template_id"/>
            </column>
        </createTable>

        <!-- ap_key_value table -->
        <createTable tableName="ap_key_value">
            <column name="key_value_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_key_value"/>
            </column>
            <column name="scope_id" type="int">
                <constraints foreignKeyName="fk_ap_key_value_scope"
                             referencedTableName="ap_scope"
                             referencedColumnNames="scope_id"
                             nullable="false"/>
            </column>
            <column name="key_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="nvarchar(4000)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint columnNames="key_type, value, scope_id" constraintName="UNIQUE_key_value" tableName="ap_key_value"/>
        <createIndex indexName="ap_key_value_all_idx" tableName="ap_key_value" unique="false">
            <column name="scope_id" type="int"/>
            <column name="key_type" type="nvarchar(50)"/>
            <column name="value" type="nvarchar(4000)"/>
        </createIndex>

        <!-- ap_index table -->
        <createTable tableName="ap_index">
            <column name="index_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_index"/>
            </column>
            <column name="part_id" type="int">
                <constraints foreignKeyName="fk_ap_index_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"
                             nullable="false"/>
            </column>
            <column name="index_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="nvarchar(4000)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="ap_index_part_idx" tableName="ap_index" unique="false">
            <column name="part_id" type="int"/>
        </createIndex>

        <!-- ap_binding_sync table -->
        <createTable tableName="ap_binding_sync">
            <column name="binding_sync_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ap_binding_sync"/>
            </column>
            <column name="last_transaction" type="nvarchar(36)">
                <constraints nullable="false"/>
            </column>
            <column name="external_system_id" type="int">
                <constraints foreignKeyName="fk_binding_sync_external_system"
                             referencedTableName="ap_external_system"
                             referencedColumnNames="external_system_id"
                             nullable="false"/>
            </column>
            <column name="page" type="int"/>
            <column name="to_transaction" type="nvarchar(36)"/>
            <column name="count" type="int"/>
        </createTable>

        <!-- ext_syncs_queue_item table -->
        <createTable tableName="ext_syncs_queue_item">
            <column name="ext_syncs_queue_item_id" type="int">
                <constraints primaryKey="true" primaryKeyName="pk_ext_syncs_queue_item"/>
            </column>
            <column name="access_point_id" type="int">
                <constraints foreignKeyName="fk_ext_syncs_queue_item_access_point"
                             referencedTableName="ap_access_point"
                             referencedColumnNames="access_point_id"
                             nullable="true"/>
            </column>
            <column name="external_system_id" type="int">
                <constraints foreignKeyName="fk_ext_syncs_queue_item_external_system"
                             referencedTableName="ap_external_system"
                             referencedColumnNames="external_system_id"
                             nullable="false"/>
            </column>
            <column name="state_message" type="nvarchar(4000)"/>
            <column name="state" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="timestamp with time zone">
                <constraints nullable="false"/>
            </column>
            <column name="batch_id" type="nvarchar(50)"/>
            <column name="binding_id" type="int">
                <constraints foreignKeyName="fk_ext_syncs_queue_item_binding"
                             referencedTableName="ap_binding"
                             referencedColumnNames="binding_id"
                             nullable="true"/>
            </column>
            <column name="user_id" type="int">
                <constraints foreignKeyName="fk_ext_syncs_queue_item_user"
                             referencedTableName="usr_user"
                             referencedColumnNames="user_id"
                             nullable="true"/>
            </column>
        </createTable>
        <createIndex indexName="ext_syncs_queue_item_ap_idx" tableName="ext_syncs_queue_item" unique="false">
            <column name="access_point_id" type="int"/>
        </createIndex>        

        <!-- ap_cached_access_point table -->
        <createTable tableName="ap_cached_access_point">
            <column name="cached_access_point_id" type="int">
                <constraints primaryKey="true"
                             primaryKeyName="pk_ap_cached_access_point"
                             nullable="false"/>
            </column>
            <column name="access_point_id" type="int">
                <constraints foreignKeyName="fk_ap_cached_access_point_access_point"
                             referencedTableName="ap_access_point"
                             referencedColumnNames="access_point_id"
                             nullable="false"/>
            </column>
            <column name="data" type="${type.text}">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createIndex indexName="access_point_id_idx" tableName="ap_cached_access_point" unique="true">
            <column name="access_point_id"/>
        </createIndex>

        <!-- rul_output_filter table -->
        <createTable tableName="rul_output_filter">
            <column name="output_filter_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="filename" type="nvarchar(250)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_output_filter_rul_rule_set"
                                 baseTableName="rul_output_filter" baseColumnNames="rule_set_id"
                                 referencedTableName="rul_rule_set" referencedColumnNames="rule_set_id"/>
        <addForeignKeyConstraint constraintName="fk_rul_output_filter_package"
                                 baseTableName="rul_output_filter" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id"/>

        <!-- rul_export_filter table -->
        <createTable tableName="rul_export_filter">
            <column name="export_filter_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="code" type="nvarchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="filename" type="nvarchar(250)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="package_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="rule_set_id" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="fk_rul_export_filter_rul_rule_set"
                                 baseTableName="rul_export_filter" baseColumnNames="rule_set_id"
                                 referencedTableName="rul_rule_set" referencedColumnNames="rule_set_id"/>
        <addForeignKeyConstraint constraintName="fk_rul_export_filter_package"
                                 baseTableName="rul_export_filter" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id"/>

        <!-- ap_revision table -->
        <createTable tableName="ap_revision">
            <column name="revision_id" type="int">
                <constraints primaryKey="true"
                             primaryKeyName="pk_ap_revision"
                             nullable="false"/>
            </column>
            <column name="state_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_revision_state"
                             referencedTableName="ap_state"
                             referencedColumnNames="state_id"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints foreignKeyName="fk_ap_revision_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"
                             nullable="false"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_ap_revision_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="merge_state_id" type="int">
                <constraints nullable="true"
                    foreignKeyName="fk_ap_revision_merge_state"
                    referencedTableName="ap_state"
                    referencedColumnNames="state_id"/>
            </column>
        </createTable>

        <!-- ap_rev_part table -->
        <createTable tableName="ap_rev_part">
            <column name="part_id" type="int">
                <constraints primaryKey="true"
                             primaryKeyName="pk_ap_rev_part"
                             nullable="false"/>
            </column>
            <column name="part_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_part_rul_part_type"
                             referencedTableName="rul_part_type"
                             referencedColumnNames="part_type_id"/>
            </column>
            <column name="parent_part_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_parent_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="rev_parent_part_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_rev_parent_part"
                             referencedTableName="ap_rev_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"
                             nullable="false"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="revision_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_revision"
                             referencedTableName="ap_revision"
                             referencedColumnNames="revision_id"
                             nullable="false"/>
            </column>
            <column name="orig_part_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_part_orig_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="deleted" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- ap_rev_item table -->
        <createTable tableName="ap_rev_item">
            <column name="item_id" type="int">
                <constraints primaryKey="true"
                             primaryKeyName="pk_ap_rev_item"
                             nullable="false"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_item_create_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"
                             nullable="false"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_item_delete_change"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="object_id" type="int"/>
            <column name="item_type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_item_item_type"
                             referencedTableName="rul_item_type"
                             referencedColumnNames="item_type_id"/>
            </column>
            <column name="item_spec_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_item_item_spec"
                             referencedTableName="rul_item_spec"
                             referencedColumnNames="item_spec_id"/>
            </column>
            <column name="position" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="data_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_item_data"
                             referencedTableName="arr_data"
                             referencedColumnNames="data_id"/>
            </column>
            <column name="part_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_item_part"
                             referencedTableName="ap_rev_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="orig_object_id" type="int"/>
            <column name="deleted" type="boolean">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- ap_rev_index table -->
        <createTable tableName="ap_rev_index">
            <column name="index_id" type="int">
                <constraints primaryKey="true"
                             primaryKeyName="pk_ap_rev_index"
                             nullable="false"/>
            </column>
            <column name="part_id" type="int">
                <constraints foreignKeyName="fk_ap_rev_index_part"
                             referencedTableName="ap_rev_part"
                             referencedColumnNames="part_id"
                             nullable="false"/>
            </column>
            <column name="index_type" type="nvarchar(50)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="nvarchar(4000)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <!-- ap_rev_state table -->
        <createTable tableName="ap_rev_state">
            <column name="state_id" type="int">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="revision_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_state_revision"
                             referencedTableName="ap_revision"
                             referencedColumnNames="revision_id"/>
            </column>
            <column name="type_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_state_type"
                             referencedTableName="ap_type"
                             referencedColumnNames="ap_type_id"/>
            </column>
            <column name="preferred_part_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_rev_state_preferred_part"
                             referencedTableName="ap_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="rev_preferred_part_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_rev_state_rev_preferred_part"
                             referencedTableName="ap_rev_part"
                             referencedColumnNames="part_id"/>
            </column>
            <column name="create_change_id" type="int">
                <constraints nullable="false"
                             foreignKeyName="fk_ap_rev_state_change_create"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="delete_change_id" type="int">
                <constraints nullable="true"
                             foreignKeyName="fk_ap_rev_state_change_delete"
                             referencedTableName="ap_change"
                             referencedColumnNames="change_id"/>
            </column>
            <column name="state_approval" type="char(50)">
                <constraints nullable="false"/>
            </column>
            <column name="comment" type="text">
                <constraints nullable="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="fk_sys_external_system_property_usr_user" 
                                 baseTableName="sys_external_system_property" baseColumnNames="user_id" 
                                 referencedTableName="usr_user" referencedColumnNames="user_id"/>

        <addForeignKeyConstraint constraintName="fk_ap_external_system_ap_scope"
                                 baseTableName="ap_external_system" baseColumnNames="scope_id"
                                 referencedTableName="ap_scope" referencedColumnNames="scope_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_output_filter"
                                 baseTableName="arr_output" baseColumnNames="output_filter_id"
                                 referencedTableName="rul_output_filter" referencedColumnNames="output_filter_id"/>

        <addForeignKeyConstraint constraintName="fk_scope_rul_rule_set"
                                 baseTableName="ap_scope" baseColumnNames="rule_set_id"
                                 referencedTableName="rul_rule_set" referencedColumnNames="rule_set_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_async_request_access_point"
                                 baseTableName="arr_async_request" baseColumnNames="access_point_id"
                                 referencedTableName="ap_access_point" referencedColumnNames="access_point_id"/>

        <addForeignKeyConstraint constraintName="fk_ap_part_key_value"
                                 baseTableName="ap_part" baseColumnNames="key_value_id"
                                 referencedTableName="ap_key_value" referencedColumnNames="key_value_id"/>

        <addForeignKeyConstraint constraintName="arr_data_uri_ref_ref_template"
                                 baseTableName="arr_data_uri_ref" baseColumnNames="ref_template_id"
                                 referencedTableName="arr_ref_template" referencedColumnNames="ref_template_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_data_record_ref_binding"
                                 baseTableName="arr_data_record_ref" baseColumnNames="binding_id"
                                 referencedTableName="ap_binding" referencedColumnNames="binding_id"/>

        <addForeignKeyConstraint constraintName="fk_ap_part_access_point"
                                 baseTableName="ap_part" baseColumnNames="access_point_id"
                                 referencedTableName="ap_access_point" referencedColumnNames="access_point_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_anonymized_ap_access_point"
                                 baseTableName="arr_output" baseColumnNames="anonymized_ap_id"
                                 referencedTableName="ap_access_point" referencedColumnNames="access_point_id"/>

        <addForeignKeyConstraint constraintName="fk_dataRecordRef_record" 
                                 baseColumnNames="record_id" baseTableName="arr_data_record_ref"
                                 referencedColumnNames="access_point_id" referencedTableName="ap_access_point"/>

        <addForeignKeyConstraint constraintName="fk_permission_issue_list"
                                 baseTableName="usr_permission" baseColumnNames="issue_list_id"
                                 referencedTableName="wf_issue_list" referencedColumnNames="issue_list_id"/>

        <addForeignKeyConstraint constraintName="fk_itemType_dataType"
                                 baseTableName="rul_item_type" baseColumnNames="data_type_id"
                                 referencedTableName="rul_data_type" referencedColumnNames="data_type_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_dataRecordRef_data"
                                 baseTableName="arr_data_record_ref" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_dataUnitid_data"
                                 baseTableName="arr_data_unitid" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_dataUnitdate_data_2"
                                 baseTableName="arr_data_unitdate" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_rul_desc_item_type_package"
                                 baseTableName="rul_item_type" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_rul_desc_item_spec_package"
                                 baseTableName="rul_item_spec" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_rul_action_package"
                                 baseTableName="rul_action" baseColumnNames="package_id"
                                 referencedTableName="rul_package" referencedColumnNames="package_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_dataNull_data"
                                 baseTableName="arr_data_null" baseColumnNames="data_id"
                                 referencedTableName="arr_data" referencedColumnNames="data_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfInfo_faNode"
                                 baseTableName="arr_node_conformity" baseColumnNames="node_id"
                                 referencedTableName="arr_node" referencedColumnNames="node_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfInfo_faVersion"
                                 baseTableName="arr_node_conformity" baseColumnNames="fund_version_id"
                                 referencedTableName="arr_fund_version" referencedColumnNames="fund_version_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfMiss_nodConfInf"
                                 baseTableName="arr_node_conformity_missing" baseColumnNames="node_conformity_id"
                                 referencedTableName="arr_node_conformity" referencedColumnNames="node_conformity_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfMiss_descItmTyp"
                                 baseTableName="arr_node_conformity_missing" baseColumnNames="item_type_id"
                                 referencedTableName="rul_item_type" referencedColumnNames="item_type_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfMiss_descItmSpc"
                                 baseTableName="arr_node_conformity_missing" baseColumnNames="item_spec_id"
                                 referencedTableName="rul_item_spec" referencedColumnNames="item_spec_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfErr_nodConfInf"
                                 baseTableName="arr_node_conformity_error" baseColumnNames="node_conformity_id"
                                 referencedTableName="arr_node_conformity" referencedColumnNames="node_conformity_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_arrNodeConfErr_descItem"
                                 baseTableName="arr_node_conformity_error" baseColumnNames="desc_item_id"
                                 referencedTableName="arr_item" referencedColumnNames="item_id" onDelete="NO ACTION"/>

        <addForeignKeyConstraint constraintName="fk_item_aptype_ap_type"
                                 baseTableName="rul_item_aptype" baseColumnNames="ap_type_id"
                                 referencedTableName="ap_type" referencedColumnNames="ap_type_id"/>

        <addForeignKeyConstraint constraintName="fk_item_aptype_item_spec"
                                 baseTableName="rul_item_aptype" baseColumnNames="item_spec_id"
                                 referencedTableName="rul_item_spec" referencedColumnNames="item_spec_id"/>

        <addForeignKeyConstraint constraintName="fk_item_aptype_item_type"
                                 baseTableName="rul_item_aptype" baseColumnNames="item_type_id"
                                 referencedTableName="rul_item_type" referencedColumnNames="item_type_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_fund"
                                 baseTableName="arr_output" baseColumnNames="fund_id"
                                 referencedTableName="arr_fund" referencedColumnNames="fund_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_type"
                                 baseTableName="arr_output" baseColumnNames="output_type_id"
                                 referencedTableName="rul_output_type" referencedColumnNames="output_type_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_create_change"
                                 baseTableName="arr_output" baseColumnNames="create_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id"/>

        <addForeignKeyConstraint constraintName="fk_arr_output_delete_change"
                                 baseTableName="arr_output" baseColumnNames="delete_change_id"
                                 referencedTableName="arr_change" referencedColumnNames="change_id"/>

        <addForeignKeyConstraint constraintName="FK_par_institution_access_point_id" deferrable="false"
                                 baseColumnNames="access_point_id" baseTableName="par_institution"
                                 referencedColumnNames="access_point_id" referencedTableName="ap_access_point"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>

        <addForeignKeyConstraint constraintName="FK_usr_user_access_point_id" deferrable="false"
                                 baseColumnNames="access_point_id" baseTableName="usr_user"
                                 referencedColumnNames="access_point_id" referencedTableName="ap_access_point"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>

        <addForeignKeyConstraint constraintName="FK_AP_BINDING_ITEM_PART" deferrable="false"
                                 baseColumnNames="part_id" baseTableName="ap_binding_item"
                                 referencedColumnNames="part_id" referencedTableName="ap_part"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>
                                 
        <addForeignKeyConstraint constraintName="FK_AP_BINDING_ITEM_ITEM" deferrable="false"
                                 baseColumnNames="item_id" baseTableName="ap_binding_item"
                                 referencedColumnNames="item_id" referencedTableName="ap_item"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>

        <addForeignKeyConstraint constraintName="FK_AP_BINDING_ITEM_CREATE_CHANGE_ID" deferrable="false"
                                 baseColumnNames="create_change_id" baseTableName="ap_binding_item"
                                 referencedColumnNames="change_id" referencedTableName="ap_change"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>
        
        <addForeignKeyConstraint constraintName="FK_AP_BINDING_ITEM_DELETE_CHANGE_ID" deferrable="false"
                                 baseColumnNames="delete_change_id" baseTableName="ap_binding_item"
                                 referencedColumnNames="change_id" referencedTableName="ap_change"
                                 initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"/>

        <!-- Pridani indexu pro zrychleni StructObj dotazu -->
        <createIndex indexName="arr_item_data_idx" tableName="arr_item">
            <column name="data_id" type="int"/>
        </createIndex>
        <createIndex tableName="arr_data_structure_ref" indexName="arr_data_structure_ref_struct_obj_idx">
            <column name="structured_object_id" type="int"></column>
        </createIndex>
        <createIndex indexName="arr_structured_item_struct_obj_idx" tableName="arr_structured_item">
            <column name="structured_object_id" type="int"/>
        </createIndex>

        <!-- Pridani indexu pro zrychleni undo -->
        <createIndex indexName="arr_node_conformity_error_node_conf_idx" tableName="arr_node_conformity_error">
            <column name="node_conformity_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_node_conformity_missing_node_conf_idx" tableName="arr_node_conformity_missing">
            <column name="node_conformity_id" type="int"/>
        </createIndex>

        <!-- Pridani indexu pro zrychleni pristupu k NodeInfo -->
        <createIndex indexName="arr_node_conformity_node_idx" tableName="arr_node_conformity">
            <column name="node_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_node_conformity_fund_ver_idx" tableName="arr_node_conformity">
            <column name="fund_version_id" type="int"/>
        </createIndex>

        <!-- Pridani indexu pro zrychleni mazani StructObj -->
        <createIndex indexName="arr_structured_object_fund_idx" tableName="arr_structured_object">
            <column name="fund_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_structured_object_create_change_idx" tableName="arr_structured_object">
            <column name="create_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_structured_object_delete_change_idx" tableName="arr_structured_object">
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_node_conformity_node_fund_ver_idx" tableName="arr_node_conformity" unique="true">
            <column name="node_id" type="int"/>
            <column name="fund_version_id" type="int"/>
        </createIndex>

        <!-- Pridani indexu pro zrychleni mazani -->
        <createIndex indexName="arr_fund_structure_extension_fund_idx" tableName="arr_fund_structure_extension">
            <column name="fund_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_fund_structure_extension_fund_ste_idx" tableName="arr_fund_structure_extension">
            <column name="fund_id" type="int"/>
            <column name="structured_type_extension_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_change_primary_node_idx" tableName="arr_change">
            <column name="primary_node_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_level_node_create_change_idx" tableName="arr_level">
            <column name="node_id" type="int"/>
            <column name="create_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_fund_version_fund_idx" tableName="arr_fund_version">
            <column name="fund_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_file_fund_idx" tableName="arr_file">
            <column name="fund_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_fund_register_scope_fund_idx" tableName="arr_fund_register_scope">
            <column name="fund_id" type="int"/>
        </createIndex>
        
        <!-- id="20200814152829" author="ppyt" -->
        <createIndex indexName="ap_access_point_uuid_idx" tableName="ap_access_point" unique="true">
            <column name="uuid" type="char(36)"/>
        </createIndex>
        <createIndex indexName="ap_state_access_point_idx" tableName="ap_state" unique="false">
            <column name="access_point_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_state_access_point_create_change_idx" tableName="ap_state" unique="false">
            <column name="access_point_id" type="int"/>
            <column name="create_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_state_access_point_delete_change_idx" tableName="ap_state" unique="true">
            <column name="access_point_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_state_type_idx" tableName="ap_state" unique="false">
            <column name="ap_type_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_state_scope_idx" tableName="ap_state" unique="false">
            <column name="scope_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_part_access_point_idx" tableName="ap_part" unique="false">
            <column name="access_point_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_part_access_point_delete_idx" tableName="ap_part" unique="false">
            <column name="access_point_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_part_parent_part_delete_idx" tableName="ap_part" unique="false">
            <column name="parent_part_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_item_part_idx" tableName="ap_item" unique="false">
            <column name="part_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_item_part_delete_idx" tableName="ap_item" unique="false">
            <column name="part_id" type="int"/>
            <column name="delete_change_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_item_type_idx" tableName="ap_item" unique="false">
            <column name="item_type_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_access_point_pref_part_idx" tableName="ap_access_point" unique="true">
            <column name="preferred_part_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_data_record_ref_record_idx" tableName="arr_data_record_ref" unique="false">
            <column name="record_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_data_record_ref_binding_idx" tableName="arr_data_record_ref" unique="false">
            <column name="binding_id" type="int"/>
        </createIndex>
        <createIndex indexName="ap_binding_state_binding_idx" tableName="ap_binding_state" unique="false">
            <column name="binding_id" type="int"/>
        </createIndex>

        <createIndex indexName="arr_output_template_output_idx" tableName="arr_output_template" unique="false">
            <column name="output_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_output_restriction_scope_output_idx" tableName="arr_output_restriction_scope" unique="false">
            <column name="output_id" type="int"/>
        </createIndex>
        <createIndex indexName="arr_node_output_output_idx" tableName="arr_node_output" unique="false">
            <column name="output_id" type="int"/>
        </createIndex>

        <!-- Create uniqueue index for not null items -->
        <sql dbms="postgresql">CREATE UNIQUE INDEX arr_structured_object_uuid_pidx
                               ON arr_structured_object(uuid, fund_id, structured_type_id)
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX ap_item_object_pidx
                               ON ap_item(object_id)
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX arr_item_object_pidx
                               ON arr_item(desc_item_object_id)
                               WHERE delete_change_id IS NULL</sql>
          <sql dbms="postgresql">CREATE UNIQUE INDEX ap_binding_state_binding_pidx 
                               ON ap_binding_state(binding_id) 
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX ap_item_data_pidx 
                               ON ap_item(data_id) 
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX ap_binding_state_access_point_idx 
                               ON ap_binding_state(access_point_id,external_system_id)
                               WHERE delete_change_id IS NULL;</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX arr_level_parent_position_idx 
                               ON arr_level(node_id_parent, "position")
                               WHERE delete_change_id IS NULL AND node_id_parent IS NOT NULL;</sql>
        <sql dbms="postgresql">CREATE INDEX arr_structured_object_error_idx
                               ON arr_structured_object(structured_type_id, fund_id, delete_change_id, sort_value, state)
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE UNIQUE INDEX ap_rev_state_revision_idx
                               ON ap_rev_state(revision_id)
                               WHERE delete_change_id IS NULL</sql>
        <sql dbms="postgresql">CREATE INDEX ap_binding_item_binding_pidx 
                               ON ap_binding_item(binding_id, delete_change_id)
                               WHERE delete_change_id IS NULL</sql>

        <!-- usr_permission_viewview -->
        <createView viewName="usr_permission_view" replaceIfExists="true">
            SELECT DISTINCT
                p.permission_id AS id,
                p.permission,
                CASE WHEN p.user_id IS NULL THEN gu.user_id ELSE p.user_id END AS user_id,
                p.fund_id,
                p.scope_id,
                p.issue_list_id
            FROM usr_permission p
            LEFT JOIN usr_user u ON p.user_id = u.user_id
            LEFT JOIN usr_group_user gu ON gu.group_id = p.group_id
        </createView>
    </changeSet>
</databaseChangeLog>